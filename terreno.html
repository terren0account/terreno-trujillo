<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mapa Interactivo</title>
    <style>
        body {
            margin: 0;
            min-height: 100vh;
            background: #1a1a1a;
            color: #fff;
            font-family: Arial, sans-serif;
            display: grid;
            place-items: center;
        }

        #map-container {
            width: 90vw;
            height: 90vh;
            position: relative;
            overflow: hidden;
            border-radius: 8px;
            background: #000;
            box-shadow: 0 4px 6px #0003;
            touch-action: none; /* Mejora el rendimiento en dispositivos móviles */
        }

        #map {
            position: absolute;
            top: 50%;
            left: 50%;
            transform-origin: center;
            transition: transform 0.2s;
            max-width: none;
            cursor: grab;
        }

        .panel {
            position: absolute;
            right: 10px;
            padding: 15px;
            border-radius: 8px;
            background: #282828e6;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 1000;
            font-size: 14px;
        }

        #controls { top: 20px; }
        #info { bottom: 20px; }

        .btn {
            padding: 10px 15px;
            border: 2px solid #2196F3;
            border-radius: 8px;
            background: transparent;
            color: #2196F3;
            cursor: pointer;
            transition: 0.2s;
        }

        .btn:hover { 
            background: #2196F3;
            color: white;
        }

        .btn:active { 
            transform: scale(0.98); 
        }

        .btn:disabled { 
            background: #555;
            cursor: not-allowed;
        }

        @media (max-width: 600px) {
            .panel {
                font-size: 12px;
                right: 5px;
            }

            #controls {
                top: 10px;
            }

            #info {
                bottom: 10px;
            }

            .btn {
                padding: 8px 12px;
                font-size: 12px;
            }

            #zoomSlider {
                width: 100%;
                margin-top: 10px;
            }

            #zoomLevel {
                text-align: center;
            }
        }

        #goHome {
            position: absolute;
            top: 10px;
            left: 10px;
            padding: 10px 15px;
            border: 2px solid #ff5722;
            background-color: transparent;
            color: #ff5722;
            border-radius: 8px;
            cursor: pointer;
            z-index: 1000;
        }

        #goHome:hover {
            background-color: #ff5722;
            color: white;
        }
    </style>
</head>
<body>
    <div id="map-container">
        <img id="map" src="mapa.svg" alt="Mapa" draggable="false">
        
        <div id="controls" class="panel">
            <div id="zoomSliderContainer">
                <input type="range" id="zoomSlider" min="50" max="300" value="100">
                <div id="zoomLevel">100%</div>
            </div>
            <button id="reset" class="btn">Reset</button>
        </div>

        <div id="info" class="panel">
            <div>Rueda del ratón: zoom</div>
            <div>Click + arrastrar: mover</div>
        </div>

        <button id="goHome">Ir a Inicio</button>
    </div>

    <script>
        class MapViewer {
            constructor(containerId) {
                this.container = document.getElementById(containerId);
                this.map = this.container.querySelector('img');
                this.zoomLevel = document.getElementById('zoomLevel');
                this.zoomSlider = document.getElementById('zoomSlider');
                this.resetButton = document.getElementById('reset');
                this.goHomeButton = document.getElementById('goHome');

                this.state = {
                    scale: 1,
                    x: 0,
                    y: 0,
                    initialScale: 1,
                    initialX: 0,
                    initialY: 0,
                    isDragging: false,
                    bounds: null,
                    lastTouchDistance: null
                };

                this.config = {
                    minZoom: 0.5,
                    maxZoom: 3,
                    zoomStep: 1.1,
                    moveLimit: 100
                };

                this.init();
            }

            init() {
                this.map.onload = () => this.setInitialState();
                this.container.onmousedown = e => this.startDrag(e.clientX, e.clientY);
                this.container.ontouchstart = e => this.startTouch(e);
                this.container.onmousemove = e => this.drag(e.clientX, e.clientY);
                this.container.ontouchmove = e => this.dragTouch(e);
                this.container.onwheel = e => this.handleZoom(e);
                
                ['mouseup', 'mouseleave', 'touchend'].forEach(event => 
                    this.container.addEventListener(event, () => this.state.isDragging = false));

                this.zoomSlider.oninput = () => this.setZoomFromSlider();
                this.resetButton.onclick = () => this.reset();
                this.goHomeButton.onclick = () => window.location.href = 'index.html';
            }

            setInitialState() {
                const container = this.container.getBoundingClientRect();
                const map = this.map.getBoundingClientRect();

                this.state.initialX = (container.width - map.width) / 2;
                this.state.initialY = (container.height - map.height) / 2;

                this.state.x = this.state.initialX;
                this.state.y = this.state.initialY;

                this.updateTransform();
            }

            reset() {
                this.state.scale = this.state.initialScale;
                this.state.x = this.state.initialX;
                this.state.y = this.state.initialY;

                this.updateTransform();
                this.zoomSlider.value = 100;
                this.updateZoomLevel();
            }

            updateTransform() {
                this.map.style.transform = 
                    `translate(-50%, -50%) scale(${this.state.scale}) 
                     translate(${this.state.x / this.state.scale}px, ${this.state.y / this.state.scale}px)`;
            }

            updateZoomLevel() {
                this.zoomLevel.textContent = `${Math.round(this.state.scale * 100)}%`;
            }
        }

        const mapViewer = new MapViewer('map-container');
    </script>
</body>
</html>
