<script>
    const mapContainer = document.getElementById('map-container');
    const map = document.getElementById('map');
    const resetBtn = document.getElementById('reset-btn');
    const zoomSlider = document.getElementById('zoom-slider');

    let scale = 1;
    let startX = 0, startY = 0;
    let offsetX = 0, offsetY = 0;
    let isDragging = false;
    let isMoving = false; // Estado de "clic para mover" también aplicable en móviles

    // Alternar modo mover con un clic o toque
    mapContainer.addEventListener('click', () => {
        isMoving = !isMoving;
        mapContainer.style.cursor = isMoving ? 'grabbing' : 'grab';
    });

    // Manejo de eventos para arrastre en PC
    mapContainer.addEventListener('mousedown', (e) => {
        if (isMoving) {
            isDragging = true;
            startX = e.clientX - offsetX;
            startY = e.clientY - offsetY;
        }
    });

    mapContainer.addEventListener('mouseup', () => {
        isDragging = false;
    });

    mapContainer.addEventListener('mousemove', (e) => {
        if (isDragging) {
            offsetX = e.clientX - startX;
            offsetY = e.clientY - startY;
            map.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
        }
    });

    // Manejo de eventos para arrastre en móviles
    mapContainer.addEventListener('touchstart', (e) => {
        if (isMoving && e.touches.length === 1) {
            isDragging = true;
            const touch = e.touches[0];
            startX = touch.clientX - offsetX;
            startY = touch.clientY - offsetY;
        }
    });

    mapContainer.addEventListener('touchmove', (e) => {
        if (isDragging && e.touches.length === 1) {
            const touch = e.touches[0];
            offsetX = touch.clientX - startX;
            offsetY = touch.clientY - startY;
            map.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
        }
    });

    mapContainer.addEventListener('touchend', () => {
        isDragging = false;
    });

    // Zoom con la rueda del mouse
    mapContainer.addEventListener('wheel', (e) => {
        e.preventDefault();
        const zoomSpeed = 0.1;
        scale += e.deltaY < 0 ? zoomSpeed : -zoomSpeed;
        scale = Math.min(10, Math.max(0.5, scale)); // Limitar el zoom
        map.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
        zoomSlider.value = scale;
    });

    // Sincronizar zoom con la barra deslizadora
    zoomSlider.addEventListener('input', (e) => {
        scale = parseFloat(e.target.value);
        map.style.transform = `translate(${offsetX}px, ${offsetY}px) scale(${scale})`;
    });

    // Resetear el mapa
    resetBtn.addEventListener('click', () => {
        scale = 1;
        offsetX = 0;
        offsetY = 0;
        map.style.transform = `translate(0px, 0px) scale(1)`;
        zoomSlider.value = 1;
    });
</script>
